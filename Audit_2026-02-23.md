# Portfolio v2 — Audit
**Date:** 2026-02-23
**Last verified:** 2026-02-23

---

## 1. Duplicate React Keys in Projects Grid
- **File:** `src/app/projects/page.tsx` lines 162, 190
- **Severity:** Critical
- **Issue:** The card `<button>` uses `key={project.id}` and the expanded panel `<div>` uses `key={expandedProject.id}`. When a project is expanded, both siblings have the same key value, causing a React duplicate key warning and potential rendering bugs. The expanded panel key should be namespaced, e.g., `key={expandedProject.id + '-expanded'}`.

## 2. Missing GSAP Cleanup in Expand Effect
- **File:** `src/app/projects/page.tsx` lines 55–123
- **Severity:** Medium
- **Issue:** The `useEffect` that runs GSAP expand/reveal animations has no cleanup return. If `expandedId` changes rapidly (user clicks multiple cards quickly), prior GSAP tweens continue running against potentially stale DOM elements.

## 3. White Body Background Causes Flash on Dark Pages
- **File:** `src/app/globals.css` lines 10, 20
- **Severity:** Medium
- **Issue:** Body has `background-color: rgb(var(--background))` where `--background` is `255 255 255` (white). Every page uses a dark background (`--dark-bg` or `--foreground`). During initial load or route transitions, users may see a white flash before page content renders.

## 4. `--text-primary` and `--text-secondary` Are Identical
- **File:** `src/app/globals.css` lines 15–16
- **Severity:** Medium
- **Issue:** Both are `237 236 232`. The bottom navbar uses `--text-secondary` for default links and `--text-primary` for `.active`/`:hover`, making the active state visually indistinguishable from inactive. Either differentiate or consolidate.

## 5. No CSRF/Bot Protection on Contact Endpoint
- **File:** `php/mailer.php` (whole file), `src/components/ContactForm.tsx`
- **Severity:** Medium
- **Issue:** The PHP endpoint accepts any POST with correct fields. CORS restricts browser cross-origin requests but not direct HTTP requests from bots/scripts. A honeypot field would reduce spam with minimal effort.

## 6. PHP Rate Limit Files in World-Readable Temp Directory
- **File:** `php/mailer.php` lines 43–54
- **Severity:** Medium
- **Issue:** Rate limit data stored in `sys_get_temp_dir() . '/portfolio_rate_limit'`. On shared hosting (cPanel), this is often `/tmp` which other users can read/modify/delete. The directory should be within the site's private file space.

## 7. PHP Rate Limit TOCTOU Race Condition
- **File:** `php/mailer.php` lines 46–54
- **Severity:** Low
- **Issue:** Rate limit file is read, checked, and written without file locking. Concurrent requests can all pass the check before any write completes. Use `flock()` for atomicity.

## 8. About/Contact Pages Lack Bottom Padding for Fixed Navbar
- **File:** `src/app/globals.css` lines 249–254, 305–312
- **Severity:** Medium
- **Issue:** `.about-page` and `.contact-page` use `height: 100vh` with centered content but don't account for the fixed bottom navbar (72px). The navbar overlaps content at the bottom. Projects page correctly uses `padding-bottom: 90px`.

## 9. Dead `pointer-events: auto` in Bottom Navbar CSS
- **File:** `src/app/globals.css` line 120
- **Severity:** Low
- **Issue:** CSS sets `pointer-events: auto` on `.bottom-navbar`, but `BottomNavbar.tsx` applies pointer-events inline based on `visible` prop. The CSS declaration is dead code.

## 10. `@theme` Block Defines Unused Font Tokens
- **File:** `src/app/globals.css` lines 3–6
- **Severity:** Low
- **Issue:** The `@theme` block defines `--font-sans` and `--font-serif` for Tailwind utility classes (`font-sans`, `font-serif`), but no component uses these utilities. All font usage is via explicit `font-family` in CSS rules. Dead configuration.

## 11. Unnecessary `calc()` Wrapper
- **File:** `src/app/globals.css` line 446
- **Severity:** Low
- **Issue:** `min-height: calc(115vh)` — the `calc()` is unnecessary with a single value and no arithmetic. Should be `min-height: 115vh`.

## 12. Redundant Mobile Font-Size Override
- **File:** `src/app/globals.css` lines 291–297 vs 465–467
- **Severity:** Low
- **Issue:** `.about-body p { font-size: clamp(0.8rem, 1.2vw, 1rem); }` is repeated identically inside the `@media (max-width: 768px)` block. The mobile override is a no-op.

## 13. `useTransitionProvider` Returns Unused `TransitionContext`
- **File:** `src/components/TransitionContext.tsx` line 41
- **Severity:** Low
- **Issue:** The hook returns `TransitionContext` in its return object, but `Transition.tsx` imports it directly from the module. Dead return value.

## 14. Archived File References Deleted Export
- **File:** `src/components/_archive/ProjectOverlay.tsx` line 6
- **Severity:** Low
- **Issue:** Imports `useLenisInstance` from `LenisProvider`, which no longer exports it. Would cause a build error if re-activated. Should be deleted.

## 15. Redundant `list-style: none`
- **File:** `src/app/globals.css` lines 128, 134
- **Severity:** Low
- **Issue:** `list-style: none` is set on both `.bottom-navbar-links` and `.bottom-navbar-links li`. The parent declaration is inherited, making the child one redundant.

## 16. Lenis Smooth Scroll on Every Page
- **File:** `src/components/LenisProvider.tsx`
- **Severity:** Low
- **Issue:** Lenis runs a continuous `requestAnimationFrame` loop on every page via the root layout. On single-viewport pages (about, contact) with minimal scroll content, this is unnecessary overhead.

---

## Summary

| # | Issue | Severity |
|---|-------|----------|
| 1 | Duplicate React keys in projects grid | Critical |
| 2 | Missing GSAP cleanup in expand effect | Medium |
| 3 | White body background flash on dark pages | Medium |
| 4 | `--text-primary`/`--text-secondary` identical (active state invisible) | Medium |
| 5 | No CSRF/bot protection on contact endpoint | Medium |
| 6 | Rate limit files in world-readable temp dir | Medium |
| 7 | Rate limit TOCTOU race condition | Low |
| 8 | About/Contact missing bottom padding for navbar | Medium |
| 9 | Dead `pointer-events: auto` in navbar CSS | Low |
| 10 | `@theme` defines unused font tokens | Low |
| 11 | Unnecessary `calc()` wrapper | Low |
| 12 | Redundant mobile font-size override | Low |
| 13 | `useTransitionProvider` returns unused value | Low |
| 14 | Archived file references deleted export | Low |
| 15 | Redundant `list-style: none` | Low |
| 16 | Lenis on every page | Low |
